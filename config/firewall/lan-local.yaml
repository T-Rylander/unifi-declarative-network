# config/firewall/lan-local.yaml â€” Production LAN LOCAL Rules (default deny)
# Traffic destined for the gateway itself (SSH, DNS, DHCP, etc.)

rules:
	- name: Allow DHCP from all VLANs
		action: accept
		protocol: udp
		src_port: 68
		dst_port: 67

	- name: Allow VLAN1 (Management) -> Gateway services
		action: accept
		protocol: tcp
		src_network: 10.0.1.0/27
		dst_ports: [22, 53, 443, 8443]

	- name: Allow VLAN1 (Management) -> DNS (UDP)
		action: accept
		protocol: udp
		src_network: 10.0.1.0/27
		dst_port: 53

	- name: Allow DNS from VLAN30, VLAN40, and VLAN90 to gateway
		action: accept
		protocol: udp
		src_networks: [10.0.30.0/24, 10.0.40.0/27, 10.0.90.0/25]
		dst_port: 53

	- name: Allow SSH from VLAN10 only
		action: accept
		protocol: tcp
		src_network: 10.0.10.0/26
		dst_port: 22

	- name: Allow Users to Servers common ports
		action: accept
		protocol: tcp
		src_network: 10.0.30.0/24
		dst_network: 10.0.10.0/26
		dst_ports: [80, 443, 445, 3389]

	- name: Allow VoIP to FreePBX
		action: accept
		protocol: udp
		src_network: 10.0.40.0/27
		dst_network: 10.0.10.0/26
		dst_ports: [5060, 5061, 10000-20000]


	- name: Default deny to gateway
		action: drop
		logging: true

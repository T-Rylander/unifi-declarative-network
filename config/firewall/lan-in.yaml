# config/firewall/lan-in.yaml â€” Production LAN IN Rules (default deny)
# Inter-VLAN traffic entering the gateway from LAN-side interfaces

rules:
	- name: Allow established/related
		action: accept
		state: [established, related]

	- name: Drop invalid packets
		action: drop
		state: [invalid]

	- name: Allow VLAN30 -> DNS on VLAN10
		action: accept
		protocol: udp
		src_network: 10.0.30.0/24
		dst_network: 10.0.10.10/32
		dst_port: 53

	- name: Allow VLAN40 (VoIP) -> DNS on VLAN10
		action: accept
		protocol: udp
		src_network: 10.0.40.0/27
		dst_network: 10.0.10.10/32
		dst_port: 53

	- name: Allow VLAN90 (Guest) -> DNS on gateway
		action: accept
		protocol: udp
		src_network: 10.0.90.0/25
		dst_port: 53

	- name: Allow VLAN90 -> Internet only (block other VLANs)
		action: accept
		src_network: 10.0.90.0/25
		dst_network: '!10.0.0.0/8'

	- name: Block VLAN90 -> Internal networks
		action: drop
		src_network: 10.0.90.0/25
		dst_networks: [10.0.10.0/26, 10.0.30.0/24, 10.0.40.0/27, 10.0.1.0/24]
		logging: true

	- name: Allow VLAN30 -> NTP (Internet)
		action: accept
		protocol: udp
		src_network: 10.0.30.0/24
		dst_port: 123

	- name: Default deny inter-VLAN
		action: drop
		logging: true
